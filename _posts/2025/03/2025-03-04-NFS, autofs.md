---
layout: single
title: NFS, AutoFS
categories: Linux
tags:
  - Linux
  - File-System
toc: true
---
## **λ©μ°¨**

1. NFS/AutoFS κ°μ”
2. NFS+AutoFS κµ¬μ„± νλ¦„
3. NFS+AutoFS κµ¬μ„± μ¥μ  λ° ν


## 1. NFSλ€? 
- Network File System 
- μ„λ²„ λ””λ ‰ν„°λ¦¬λ¥Ό λ„¤νΈμ›ν¬λ΅ κ³µμ , ν΄λΌμ΄μ–ΈνΈκ°€ μ›κ²© λ§μ΄νΈ
- λ€ν‘μ  νμΌ κ³µμ  ν”„λ΅ν† μ½ (POSIX κ¶ν• μ μ§€)

### μ£Όμ” νΉμ§•
| ν•­λ© | λ‚΄μ© |
|---|---|
| ν”„λ΅ν† μ½ | TCP/UDP (μ£Όλ΅ TCP) |
| κ¶ν• κ΄€λ¦¬ | νμΌ/λ””λ ‰ν„°λ¦¬ νΌλ―Έμ… μ μ§€ |
| λ³΄μ• | IP μ ν•, NFSv4μ—μ„λ” Kerberos κ°€λ¥ |
| λ€ν‘ λ…λ Ή | `exportfs`, `showmount`, `mount` |

---

## 2. AutoFSλ€?
- ν•„μ”ν•  λ•λ§ λ§μ΄νΈ, μΌμ • μ‹κ°„ λ―Έμ‚¬μ© μ‹ μλ™ μ–Έλ§μ΄νΈ
- μ‹μ¤ν… λ¶€ν• κ°μ†, μ¬λ¶€ν… μ‹ λ§μ΄νΈ λ¬Έμ  λ°©μ§€

### μ£Όμ” νΉμ§•
| ν•­λ© | μ„¤λ… |
|---|---|
| μλ™ λ§μ΄νΈ | λ””λ ‰ν„°λ¦¬μ— μ ‘κ·Όν•  λ• μλ™ λ§μ΄νΈ |
| λΉ„ν™μ„±ν™” κ΄€λ¦¬ | μΌμ • μ‹κ°„ μ‚¬μ©ν•μ§€ μ•μΌλ©΄ μλ™ ν•΄μ  (timeout) |
| μ„¤μ • νμΌ | `/etc/auto.master` μ™€ `/etc/auto.*`λ΅ κ΄€λ¦¬ |
| λ©”λ¨λ¦¬ μ μ•½ | ν•„μ”ν•  λ•λ§ λ§μ΄νΈν•λ―€λ΅ λ¦¬μ†μ¤ μ κ° |

### μ£Όμ” κµ¬μ„± νμΌ
| νμΌλ… | μ„¤λ… |
|---|---|
| /etc/auto.master | λ§μ¤ν„° μ„¤μ • νμΌ (λ§µνμΌ μ§€μ •) |
| /etc/auto.* | μ‹¤μ  λ§μ΄νΈ κ·μΉ™ μ •μ |

---

## 3. NFS + AutoFS κµ¬μ„± νλ¦„
```
[μ‚¬μ©μ μ ‘κ·Ό] β†’ [AutoFS λ™μ‘] β†’ [NFS λ§μ΄νΈ]
β†’ [νμΌ μ ‘κ·Ό κ°€λ¥] β†’ [λ―Έμ‚¬μ© μ‹ μ–Έλ§μ΄νΈ]
```

```
+------------------+
| NFS μ„λ²„          |
| /data/share       |
|                  |
+------------------+
           |
           | 192.168.0.0/24
           |
+------------------+
| NFS ν΄λΌμ΄μ–ΈνΈ    |
| autofs κ΄€λ¦¬      |
| /mnt/nfs/share   |
|                  |
+------------------+
```

## 4. NFS μ„λ²„ μ„¤μ • μμ‹

### /etc/exports
```
/data/shared 192.168.0.0/24(rw,sync,no_root_squash)
```

### μ„λΉ„μ¤ μ¬μ‹μ‘
```
systemctl restart nfs-server
exportfs -rv
```


## 5. ν΄λΌμ΄μ–ΈνΈ AutoFS μ„¤μ • μμ‹

### /etc/auto.master
```
/mnt/nfs /etc/auto.nfs
```

### /etc/auto.nfs
```
share -fstype=nfs,rw 192.168.0.100:/data/shared
```

### μ„λΉ„μ¤ μ¬μ‹μ‘
```
systemctl restart autofs
```

### λ§μ΄νΈ μƒνƒ ν™•μΈ
```
cat /proc/mounts | grep autofs
```

---
## β… 6. NFS+autofs κµ¬μ„± μ¥μ 
| μ¥μ      | μ„¤λ…                                   |
| ------ | ------------------------------------ |
| μ„±λ¥     | λ¶€ν… μ‹ λ¶ν•„μ”ν• λ§μ΄νΈ X (ν•„μ”ν•  λ•λ§ λ§μ΄νΈ)         |
| μμ› μ μ•½  | ν•„μ”ν•  λ•λ§ λ§μ΄νΈν•λ―€λ΅ λ©”λ¨λ¦¬, λ„¤νΈμ›ν¬ λ¶€λ‹΄ κ°μ†        |
| κ΄€λ¦¬ νΈμμ„± | ν΄λΌμ΄μ–ΈνΈ μ„¤μ • λ³€κ²½ μ—†μ΄ μ„λ²„ μ¶”κ°€ κ°€λ¥ (auto.*λ§ μμ •) |
| μ¥μ•  λ³µμ›λ ¥ | λ„¤νΈμ›ν¬ μ¥μ•  μ‹ μ¦‰μ‹ μ–Έλ§μ΄νΈ, μ¬μ ‘μ† μ‹ μλ™ μ¬λ§μ΄νΈ     |

### π“ κΈ°νƒ€ ν
- **NFSv4 κ¶μ¥** (λ³΄μ• λ° μ„±λ¥ κ°μ„ )
- `/etc/exports`μ—μ„ `ro`/`rw`, `no_root_squash` λ“± μµμ… μ μ²΄ν¬
- ν•„μ”ν•λ©΄ **NFS + Kerberos**λ΅ λ³΄μ• κ°•ν™” κ°€λ¥
- κ³µμ  λ””λ ‰ν„°λ¦¬ κ¶ν• κ΄€λ¦¬λ” **NFS μ„λ²„**μ—μ„ μ„¤μ •  
- ν΄λΌμ΄μ–ΈνΈλ” κΈ°λ³Έμ μΌλ΅ μ½κΈ°/μ“°κΈ°λ§ μ μ–΄ κ°€λ¥  
- SELinux ν™μ„± ν™κ²½μ—μ„λ” NFS κ΄€λ ¨ λ³΄μ• μ»¨ν…μ¤νΈ ν™•μΈ ν•„μ (RHELκ³„μ—΄)  
- λ„¤νΈμ›ν¬ λ¶μ•μ •ν• ν™κ²½μ—μ„λ” autofs timeout μ΅°μ • κ¶μ¥
```
/etc/autofs.conf
timeout = 300  # κΈ°λ³Έ 5λ¶„, ν•„μ”μ‹ μ΅°μ •
```

---
